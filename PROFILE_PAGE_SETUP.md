# 會員中心頁面功能說明

## ✅ 已完成功能

### 1. 會員中心頁面 (`/profile`)
- ✅ 個人資料管理：顯示姓名、Email，並標示會員等級
- ✅ 訂單查詢：列出歷史訂單、付款狀態
- ✅ 匯款後五碼回填：會員可在訂單詳情中回填匯款後五碼
- ✅ 右上角人像圖示正確連結至 `/profile`

### 2. Radio Group 編譯錯誤
- ✅ 已修復：`components/ui/radio-group.tsx` 已添加 `"use client"` 指令
- ✅ 確保正確引用 `@radix-ui/react-radio-group`

### 3. 優惠設定邏輯
- ✅ 免運功能：當優惠券標記為 `is_free_shipping: true` 且達到消費門檻時，運費設為 0
- ✅ 折扣金額：支援「折價金額」（fixed）與「百分比」（percentage）兩種計算方式
- ✅ 消費門檻驗證：檢查訂單金額是否達到優惠碼的最低消費金額

### 4. VIP 自動折扣系統
- ✅ VIP 會員：總金額自動打 9 折（折扣 10%）
- ✅ VVIP 會員：總金額自動打 85 折（折扣 15%）
- ✅ 結帳明細中清楚標示「VIP 專屬優惠」或「VVIP 專屬優惠」

### 5. 銀行轉帳與後五碼
- ✅ 結帳頁面提供銀行轉帳選項
- ✅ 實作儲存 `remittance_last_five` 欄位的邏輯
- ✅ 會員可在 `/profile` 頁面查看或回填匯款後五碼

## 📋 功能詳情

### 會員中心頁面功能

#### 個人資料管理
- 顯示會員 Email（不可編輯）
- 顯示並可編輯姓名、電話、地址
- 顯示會員等級標籤（一般會員/VIP/VVIP）

#### 訂單查詢
- 顯示所有歷史訂單
- 顯示訂單編號、狀態、金額、日期
- 顯示支付方式
- 顯示訂單項目清單
- 提供「查看訂單詳情」連結

#### 匯款後五碼回填
- 僅在「等待匯款確認」狀態的銀行轉帳訂單顯示回填欄位
- 會員可輸入並儲存匯款後五碼
- 已填寫的匯款後五碼會顯示在訂單資訊中

### 結帳頁面功能

#### 優惠碼系統
- 支援固定金額折扣（fixed）
- 支援百分比折扣（percentage）
- 支援免運費功能（is_free_shipping）
- 消費門檻驗證（min_purchase_amount）

#### VIP 折扣系統
- 自動檢查 `profiles.member_level`
- VIP：9 折（折扣 10%）
- VVIP：85 折（折扣 15%）
- 在訂單摘要中清楚標示

#### 銀行轉帳
- 選擇銀行轉帳時顯示銀行資訊
- 必填匯款後五碼欄位
- 儲存至 `remittance_last_five` 欄位

## 🔧 使用說明

### 訪問會員中心
1. 登入後，點擊右上角人像圖示
2. 或直接訪問 `/profile`

### 編輯個人資料
1. 在會員中心頁面點擊「編輯」圖示
2. 修改姓名、電話、地址
3. 點擊「儲存」按鈕

### 回填匯款後五碼
1. 在會員中心的訂單列表中
2. 找到「等待匯款確認」狀態的銀行轉帳訂單
3. 在「匯款資訊」區塊輸入後五碼
4. 點擊「儲存」按鈕

### 查看訂單詳情
1. 在會員中心的訂單列表中
2. 點擊「查看訂單詳情」按鈕
3. 跳轉至訂單確認頁面查看完整資訊

## ⚠️ 注意事項

1. **權限控制**：未登入用戶訪問 `/profile` 會自動跳轉至登入頁面
2. **資料同步**：個人資料更新後會立即同步到資料庫
3. **匯款後五碼**：僅在「等待匯款確認」狀態時可回填
4. **會員等級**：由後台管理員在 `/admin/users` 頁面設定

## 🎯 測試清單

- [ ] 測試會員中心頁面載入
- [ ] 測試個人資料編輯功能
- [ ] 測試訂單查詢功能
- [ ] 測試匯款後五碼回填功能
- [ ] 測試 VIP 折扣自動計算
- [ ] 測試 VVIP 折扣自動計算
- [ ] 測試優惠碼免運費功能
- [ ] 測試消費門檻驗證
- [ ] 測試銀行轉帳流程
